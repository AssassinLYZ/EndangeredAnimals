var ToolsetDynamicSources=function(e){var t={};function r(n){if(t[n])return t[n].exports;var o=t[n]={i:n,l:!1,exports:{}};return e[n].call(o.exports,o,o.exports,r),o.l=!0,o.exports}return r.m=e,r.c=t,r.d=function(e,t,n){r.o(e,t)||Object.defineProperty(e,t,{enumerable:!0,get:n})},r.r=function(e){"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})},r.t=function(e,t){if(1&t&&(e=r(e)),8&t)return e;if(4&t&&"object"==typeof e&&e&&e.__esModule)return e;var n=Object.create(null);if(r.r(n),Object.defineProperty(n,"default",{enumerable:!0,value:e}),2&t&&"string"!=typeof e)for(var o in e)r.d(n,o,function(t){return e[t]}.bind(null,o));return n},r.n=function(e){var t=e&&e.__esModule?function(){return e.default}:function(){return e};return r.d(t,"a",t),t},r.o=function(e,t){return Object.prototype.hasOwnProperty.call(e,t)},r.p="",r(r.s=12)}([function(e,t){e.exports=lodash},function(e,t){e.exports=window.wp.i18n},function(e,t){e.exports=window.wp.hooks},function(e,t){e.exports=window.wp.element},function(e,t){e.exports=window.wp.data},function(e,t){e.exports=window.wp.components},function(e,t){e.exports=window.wp.compose},function(e,t){e.exports=window.toolsetCommonEs.block.control},function(e,t){e.exports=window.wp.apiFetch},function(e,t){e.exports=window.wp.url},function(e,t,r){},function(e,t,r){},function(e,t,r){"use strict";r.r(t);var n=r(4),o=r(2),c=r(1),i=r(8),a=r.n(i),s=r(0),u=function(e){return e.match(/^custom_post_type\|[^\|]+\|\d+$/)||"__custom_post"===e};function l(e,t){return function(e){if(Array.isArray(e))return e}(e)||function(e,t){var r=[],n=!0,o=!1,c=void 0;try{for(var i,a=e[Symbol.iterator]();!(n=(i=a.next()).done)&&(r.push(i.value),!t||r.length!==t);n=!0);}catch(e){o=!0,c=e}finally{try{n||null==a.return||a.return()}finally{if(o)throw c}}return r}(e,t)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance")}()}function p(e,t,r,n,o,c,i){try{var a=e[c](i),s=a.value}catch(e){return void r(e)}a.done?t(s):Promise.resolve(s).then(n,o)}function f(e){return function(){var t=this,r=arguments;return new Promise((function(n,o){var c=e.apply(t,r);function i(e){p(c,n,o,i,a,"next",e)}function a(e){p(c,n,o,i,a,"throw",e)}i(void 0)}))}}var d=window.toolsetDynamicSourcesScriptData,b=function(e,t,r,n){var o=d.cacheForViews&&d.cacheForViews[t]?d.cacheForViews[t]:d.cache,c="";return void 0!==o[r]&&(c=o[r]),void 0===o[e]||void 0===o[e][r]||t!==o[e]["post-id"]&&!u(e)||(c=o[e][r]),void 0!==c[n]&&(c=c[n]),""!==c?{sourceContent:c}:null},y=function(){var e=f(regeneratorRuntime.mark((function e(t,r,o){var i,s,u,l,p,f=arguments;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(i=f.length>3&&void 0!==f[3]?f[3]:null,t&&r&&o){e.next=3;break}return e.abrupt("return",null);case 3:if(!(s=b(t,r,o,i))){e.next=6;break}return e.abrupt("return",s);case 6:return u="/toolset-dynamic-sources/v1/render-source/?source=".concat(o,"&provider=").concat(t,"&post=").concat(r),l="",i&&(l+="field=".concat(i)),""!==l&&(u+="&".concat(l)),e.prev=10,e.next=13,a()({path:u});case 13:return e.abrupt("return",e.sent);case 16:return e.prev=16,e.t0=e.catch(10),p=Object(c.sprintf)(Object(c.__)('Something went wrong while fetching the dynamic content from the selected source, with message: "%s".',"wpv-views"),e.t0.message),Object(n.dispatch)("core/notices").createErrorNotice(p,{id:"toolset_blocks_dynamic_source_content_preloading_error"}),e.abrupt("return",null);case 21:case"end":return e.stop()}}),e,null,[[10,16]])})));return function(t,r,n){return e.apply(this,arguments)}}(),m=function(){var e=f(regeneratorRuntime.mark((function e(t){return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,e.next=3,a()({path:"/toolset-dynamic-sources/v1/get-cache?post=".concat(t)});case 3:return e.abrupt("return",e.sent);case 6:return e.prev=6,e.t0=e.catch(0),e.abrupt("return",null);case 9:case"end":return e.stop()}}),e,null,[[0,6]])})));return function(t){return e.apply(this,arguments)}}(),v=function(e){return new Promise((function(t){a()({path:"/toolset-dynamic-sources/v1/search-post?s=".concat(e)}).then((function(e){var r=e.map((function(e){return{label:e.title,value:"custom_post_type|".concat(e.post_type,"|").concat(e.id)}}));t(r)}))}))},h=function(){var e=f(regeneratorRuntime.mark((function e(t){var r,n,c,i,u,p;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return r=t.value.split("|"),n=l(r,3),c=n[1],i=n[2],e.next=3,a()({path:"toolset-dynamic-sources/v1/get-source?post_type=".concat(c,"&post_id=").concat(i)});case 3:u=e.sent,p=t.value,d.postProviders.find((function(e){return e.value===p}))||d.postProviders.push({value:p,label:t.label}),Object(o.doAction)("tb.dynamicSources.actions.providers.customPostLoaded",p,t.label),d.dynamicSources[p]=u.__current_post,Object(o.doAction)("tb.dynamicSources.actions.source.customPostLoaded",p,u),m(i).then((function(e){d.cache[p]=e.__current_post,Object(o.doAction)("tb.dynamicSources.actions.cache.customPostLoaded",p,e),Object(o.doAction)("tb.caching.updated")})),Object(o.addAction)("tb.caching.tick","toolset-blocks",function(){var e=f(regeneratorRuntime.mark((function e(t){var r;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,m(i);case 2:r=e.sent,t[p]&&Object(s.isEqual)(t[p],r.__current_post)||(d.cache[p]=r.__current_post,Object(o.doAction)("tb.caching.updated"));case 4:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}());case 11:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}();function O(e,t,r,n,o,c,i){try{var a=e[c](i),s=a.value}catch(e){return void r(e)}a.done?t(s):Promise.resolve(s).then(n,o)}var g=window.toolsetDynamicSourcesScriptData,w=function(){var e,t=(e=regeneratorRuntime.mark((function e(){var t,r,c,i,a,s,u,l;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(t=Object(n.select)("core/editor"),r=JSON.stringify(t.getBlocks()),c=!!r.includes("dynamic"),i=!!r.includes("toolset-blocks/field"),a=!!r.includes("toolset-blocks/repeating-field"),s=!!r.includes("toolset-blocks/fields-and-text"),(c||s||i||a)&&!Object(n.select)(g.dynamicSourcesStore).getCacheUpdating()){e.next=8;break}return e.abrupt("return");case 8:return u=Object(n.select)(g.dynamicSourcesStore).getPreviewPost()||t.getCurrentPostId(),Object(n.dispatch)(g.dynamicSourcesStore).setCacheUpdating(!0),e.next=12,m(u);case 12:l=e.sent,Object(n.dispatch)(g.dynamicSourcesStore).setCacheUpdating(!1),Object(o.doAction)("tb.dynamicSources.actions.cache.tick",l);case 15:case"end":return e.stop()}}),e)})),function(){var t=this,r=arguments;return new Promise((function(n,o){var c=e.apply(t,r);function i(e){O(c,n,o,i,a,"next",e)}function a(e){O(c,n,o,i,a,"throw",e)}i(void 0)}))});return function(){return t.apply(this,arguments)}}(),S=function(){Object(o.addAction)("tb.dynamicSources.actions.cache.tick","toolset-blocks",(function(e){var t=!1;e&&!Object(s.isEqual)(e,g.cache)&&(g.cache=Object.assign({},g.cache,e),t=!0),g.cacheForViews&&(t=!0),t&&Object(o.doAction)("tb.dynamicSources.actions.cache.updated")})),Object(o.addAction)("tb.dynamicSources.actions.cache.initiateFetching","toolset-blocks",(function(){w()})),window.setInterval((function(){Object(o.doAction)("tb.dynamicSources.actions.cache.initiateFetching")}),3e4)};function P(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}var j=function(){function e(){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e)}var t,r,n;return t=e,(r=[{key:"get",value:function(e,t){if(e&&t)return a()({path:"/toolset-dynamic-sources/v1/dynamic-sources?post-type=".concat(e.join(","),"&preview-post-id=").concat(t)})}}])&&P(t.prototype,r),n&&P(t,n),e}();function _(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),r.push.apply(r,n)}return r}function C(e){for(var t=1;t<arguments.length;t++){var r=null!=arguments[t]?arguments[t]:{};t%2?_(r,!0).forEach((function(t){E(e,t,r[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):_(r).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(r,t))}))}return e}function E(e,t,r){return t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}var R=window.toolsetDynamicSourcesScriptData,k={dynamicSources:[]},D={setLoading:function(e,t){return{type:"SET_LOADING",blockID:e,loading:t}},setCacheUpdating:function(e){return{type:"SET_CACHE_UPDATING",cacheUpdating:e}},setPreviewPost:function(e){return{type:"SET_PREVIEW_POST",previewPost:e}},setDynamicSources:function(e){return{type:"DYNAMIC_SOURCES_SET",dynamicSources:e}},getDynamicSources:function(e,t,r){return{type:"DYNAMIC_SOURCES_GET",postTypes:e,previewPostID:t}}},F=new j,A={DYNAMIC_SOURCES_GET:function(e){return F.get(e.postTypes,e.previewPostID)}},T={getDynamicSources:regeneratorRuntime.mark((function e(t,r,n){var o;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,D.getDynamicSources(t,r,n);case 2:return o=e.sent,e.next=5,D.setDynamicSources(o);case 5:case"end":return e.stop()}}),e)}))},I={actions:D,selectors:{getLoading:function(e,t){return!!e[t]&&e[t].loading},getCacheUpdating:function(e){return!!e.cacheUpdating&&e.cacheUpdating},getPreviewPost:function(e){return e.previewPost?e.previewPost:null},getDynamicSources:function(e,t,r,n){return e.dynamicSources}},controls:A,resolvers:T,reducer:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:k,t=arguments.length>1?arguments[1]:void 0;switch(t.type){case"SET_LOADING":return C({},e,E({},t.blockID,{loading:t.loading}));case"SET_CACHE_UPDATING":return C({},e,{cacheUpdating:!!t.cacheUpdating});case"SET_PREVIEW_POST":return C({},e,{previewPost:parseInt(t.previewPost)});case"DYNAMIC_SOURCES_SET":return C({},e,{dynamicSources:t.dynamicSources})}return e}},x=function(){Object(n.registerStore)(R.dynamicSourcesStore,I)},U=r(3),L=r(5),M=r(6),N=r(9),V=r(7);r(10);function B(e){return(B="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function W(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),r.push.apply(r,n)}return r}function G(e){for(var t=1;t<arguments.length;t++){var r=null!=arguments[t]?arguments[t]:{};t%2?W(r,!0).forEach((function(t){$(e,t,r[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):W(r).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(r,t))}))}return e}function K(e,t,r,n,o,c,i){try{var a=e[c](i),s=a.value}catch(e){return void r(e)}a.done?t(s):Promise.resolve(s).then(n,o)}function H(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}function q(e){return(q=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}function Y(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function Q(e,t){return(Q=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}function $(e,t,r){return t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}var J=window.toolsetDynamicSourcesScriptData,z=function(e){function t(e){var r,n,o;return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t),n=this,o=q(t).call(this,e),r=!o||"object"!==B(o)&&"function"!=typeof o?Y(n):o,$(Y(r),"updateBlockContentFromCache",(function(){r.setState({postUrl:J.cache.__current_post["post-url"],postId:J.cache.__current_post["post-id"]})})),$(Y(r),"maybeRenderUpdatingCacheSpinner",(function(){var e=null;return r.props.isCacheUpdating&&(e=React.createElement("div",{className:"spinner-control"},React.createElement(L.Spinner,null))),e})),$(Y(r),"makePreviewUrl",(function(){var e=r.state.postUrl;return r.state.postId!==r.state.selectedPost.value&&(e=r.state.selectedPost.guid),Object(N.addQueryArgs)(e,{"content-template-id":r.props.currentPostId})})),$(Y(r),"maybeRenderPreviewLink",(function(){return React.createElement("span",{className:"editor-post-view"},React.createElement("a",{target:"wp-preview-"+r.props.currentPostId,rel:"noopener noreferrer",href:r.makePreviewUrl()},Object(c.__)("View on front-end","wpv-views")),!!r.props.hasChangedContent&&React.createElement("small",null,Object(c.__)("(Click Update button first to view the recent changes)","wpv-views")))})),r.state={selectedPost:Object(s.find)(J.previewPosts,["value",parseInt(r.props.previewPost)]),postUrl:J.cache.__current_post["post-url"],postId:J.cache.__current_post["post-id"]},r}var r,n,i,u,l;return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&Q(e,t)}(t,e),r=t,(n=[{key:"componentDidMount",value:function(){Object(o.addAction)("tb.dynamicSources.actions.cache.updated","toolset-blocks",this.updateBlockContentFromCache)}},{key:"updateDynamicSourceFromPostId",value:(u=regeneratorRuntime.mark((function e(t){var r,n;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,a()({path:"/toolset-dynamic-sources/v1/search-post?id=".concat(t)});case 2:if(!(r=e.sent)||!r.length){e.next=8;break}return e.next=6,a()({path:"toolset-dynamic-sources/v1/get-source?post_type=".concat(r[0].post_type,"&post_id=").concat(r[0].id)});case 6:n=e.sent,J.dynamicSources.__current_post=n.__current_post;case 8:case"end":return e.stop()}}),e)})),l=function(){var e=this,t=arguments;return new Promise((function(r,n){var o=u.apply(e,t);function c(e){K(o,r,n,c,i,"next",e)}function i(e){K(o,r,n,c,i,"throw",e)}c(void 0)}))},function(e){return l.apply(this,arguments)})},{key:"render",value:function(){var e=this;if(!J.previewPosts||J.previewPosts.length<1)return null;var t=Object(s.maxBy)(J.previewPosts,(function(e){return e.label.length})),r=J.previewPosts&&J.previewPosts.length>0?5*t.label.length+120:0,n={container:function(e){return G({},e,{width:"180px"})},menu:function(e){return G({},e,{width:"".concat(r,"px")})}};return React.createElement(U.Fragment,null,React.createElement("label",{htmlFor:"post-selector-".concat(this.props.instanceId)},Object(c.__)("View with","wpv-views"),": "),React.createElement(V.Select,{id:"post-selector-".concat(this.props.instanceId),value:this.state.selectedPost,defaultOptions:J.previewPosts,restInfo:{base:"/wp/v2/search",args:{search:"%s",type:"post",subtype:J.previewPostTypes}},onChange:function(t){e.updateDynamicSourceFromPostId(t.value),e.setState({selectedPost:t}),e.props.setPreviewPost(t.value),e.props.editPost({meta:{tb_preview_post:t.value}})},className:"toolset-blocks-post-selector-control",styles:n}),this.maybeRenderPreviewLink(),this.maybeRenderUpdatingCacheSpinner())}}])&&H(r.prototype,n),i&&H(r,i),t}(U.Component),X=Object(M.compose)([Object(n.withSelect)((function(e){var t=e(J.dynamicSourcesStore),r=t.getPreviewPost,n=t.getCacheUpdating,o=e("core/editor"),c=o.getCurrentPostId,i=o.hasChangedContent;return{previewPost:r(),isCacheUpdating:n(),currentPostId:c(),hasChangedContent:i()}})),Object(n.withDispatch)((function(e){var t=e("core/editor").editPost;return{setPreviewPost:e(J.dynamicSourcesStore).setPreviewPost,editPost:t}})),M.withInstanceId])(z);function Z(e){return(Z="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function ee(e){return(ee=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}function te(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function re(e,t){return(re=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}function ne(e,t,r){return t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}var oe=window.toolsetDynamicSourcesScriptData,ce=function(e){function t(){var e,r,o,c=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};if(function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t),r=this,o=ee(t).call(this,c),e=!o||"object"!==Z(o)&&"function"!=typeof o?te(r):o,ne(te(e),"PLACEHOLDER_ID","toolset-blocks-post-selector"),ne(te(e),"deferAddingPostSelector",(function(t){var r=Object(n.select)("core/editor").getCurrentPostType;if(0!==jQuery("body").length){var o=jQuery("#editor.block-editor__container");if(0!==o.length)0!==o.find(".edit-post-header-toolbar").length?Object(s.isEqual)("view-template",r())&&e.addPostSelector():setTimeout(Object(s.partial)(t,t),1)}else setTimeout(Object(s.partial)(t,t),1)})),ne(te(e),"addPostSelector",(function(){var t=jQuery("#editor.block-editor__container .edit-post-header-toolbar");0!==t.length&&(t.append('<div id="'.concat(e.PLACEHOLDER_ID,'"></div>')),Object(U.render)(React.createElement(X,null),document.querySelector("#"+e.PLACEHOLDER_ID)))})),!Object(n.select)(oe.dynamicSourcesStore).getPreviewPost()){var i=Object(s.find)(oe.previewPosts,["value",parseInt(oe.postPreview)]);i&&Object(s.has)(i,"value")&&Object(n.dispatch)(oe.dynamicSourcesStore).setPreviewPost(Object(s.get)(i,"value"))}return e.deferAddingPostSelector(e.deferAddingPostSelector),e}return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&re(e,t)}(t,e),t}(U.Component);function ie(e){return(ie="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function ae(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),r.push.apply(r,n)}return r}function se(e){return function(e){if(Array.isArray(e)){for(var t=0,r=new Array(e.length);t<e.length;t++)r[t]=e[t];return r}}(e)||function(e){if(Symbol.iterator in Object(e)||"[object Arguments]"===Object.prototype.toString.call(e))return Array.from(e)}(e)||function(){throw new TypeError("Invalid attempt to spread non-iterable instance")}()}function ue(e){return(ue=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}function le(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function pe(e,t){return(pe=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}function fe(e,t,r){return t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}var de=window,be=de.toolsetDynamicSourcesScriptData,ye=de.Toolset,me=function(e){function t(){var e,r,c,i=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t),r=this,c=ue(t).call(this,i),e=!c||"object"!==ie(c)&&"function"!=typeof c?le(r):c,fe(le(e),"postTypes",[]),fe(le(e),"previewPostId",null),fe(le(e),"viewStoreIds",[]),fe(le(e),"random",null),fe(le(e),"maybeAppendPostProvidersForCustomPost",(function(e){var t=be.postProviders.filter((function(e){return u(e.value)&&"__custom_post"!==e.value})),r=[].concat(se(e),se(t));return r.filter((function(e,t){return r.indexOf(e)===t}))})),fe(le(e),"maybeAppendDynamicSourcesForCustomPost",(function(e){var t=Object.keys(be.dynamicSources).filter((function(e){return u(e)&&"__custom_post"!==e})).reduce((function(e,t){return e[t]=be.dynamicSources[t],e}),{});return Object(s.merge)(e,t)})),fe(le(e),"maybeAppendCacheForCustomPost",(function(e){var t=Object.keys(be.cache).filter((function(e){return u(e)&&"__custom_post"!==e})).reduce((function(e,t){return e[t]=be.cache[t],e}),{});return Object(s.merge)(e,t)})),fe(le(e),"blockInsideViewAdjustmentCallback",(function(t,r,o){var c=e.maybeGetParentViewBlock(r);if(c){var i=Object(n.select)(c.attributes.reduxStoreId).getGeneral().preview_post_id;if(be["".concat(o,"ForViews")]&&be["".concat(o,"ForViews")][i])return be["".concat(o,"ForViews")][i]}return t})),fe(le(e),"maybeGetParentViewBlock",(function(e){var t=Object(n.select)("core/editor"),r=t.getBlock,o=t.getBlockRootClientId,c=null,i=e;do{if(i=o(i)){var a=r(i);Object(s.includes)(["toolset-views/view-editor","toolset-views/wpa-editor"],a.name)&&(c=a)}}while(i);return c})),Object(o.addAction)("tb.dynamicSources.actions.cache.initiateFetching","toolset-blocks",(function(){Object(n.select)("core/editor").getBlocks().filter((function(e){return"toolset-views/view-editor"===e.name})).forEach((function(e){var t=e.attributes.reduxStoreId,r=Object(n.select)(t).getGeneral(),c=Object(n.select)(t).getContentSelection();"posts"===c.query_type&&Object(o.doAction)("tb.dynamicSources.action.updateSources",c.post_type,r.preview_post_id,t)}))})),Object(o.addFilter)("tb.dynamicSources.filters.adjustPreviewPostID","toolset-blocks",(function(t,r){var o=e.maybeGetParentViewBlock(r);return o?Object(n.select)(o.attributes.reduxStoreId).getGeneral().preview_post_id:t})),Object(o.addFilter)("tb.dynamicSources.filters.adjustSourcesForBlocksInsideViews","toolset-blocks",(function(t,r){return e.blockInsideViewAdjustmentCallback(t,r,"dynamicSources")})),Object(o.addFilter)("tb.dynamicSources.filters.adjustProvidersForBlocksInsideViews","toolset-blocks",(function(t,r){return e.blockInsideViewAdjustmentCallback(t,r,"postProviders")})),Object(o.addAction)("tb.dynamicSources.action.updateSources","toolset-blocks",(function(t,r,o){e.postTypes=t,e.random=Math.random(),e.previewPostId=r,e.viewStoreIds[r]&&!e.viewStoreIds[r].includes(o)?e.viewStoreIds[r]=[].concat(se(e.viewStoreIds[r]),[o]):e.viewStoreIds[r]=[o],Object(n.select)(be.dynamicSourcesStore).getDynamicSources(e.postTypes,e.previewPostId,e.random)})),Object(o.addAction)("tb.dynamicSources.actions.providers.customPostLoaded","toolset-blocks",(function(t,r){e.previewPostId&&(be.postProvidersForViews[e.previewPostId]||(be.postProvidersForViews[e.previewPostId]=[]),be.postProvidersForViews[e.previewPostId].find((function(e){return e.value===t}))||be.postProvidersForViews[e.previewPostId].push({value:t,label:r}))}),10,3),Object(o.addAction)("tb.dynamicSources.actions.source.customPostLoaded","toolset-blocks",(function(t,r){e.previewPostId&&(be.dynamicSourcesForViews[e.previewPostId]||(be.dynamicSourcesForViews[e.previewPostId]={}),be.dynamicSourcesForViews[e.previewPostId][t]||(be.dynamicSourcesForViews[e.previewPostId][t]=r.__current_post))}),10,2),Object(o.addAction)("tb.dynamicSources.actions.cache.customPostLoaded","toolset-blocks",(function(t,r){e.previewPostId&&(be.cacheForViews[e.previewPostId]||(be.cacheForViews[e.previewPostId]={}),be.cacheForViews[e.previewPostId][t]||(be.cacheForViews[e.previewPostId][t]=r.__current_post))}),10,2),ye.hooks.addFilter("wpv-filter-wpv-shortcodes-gui-post-id-for-dialog-create",(function(t){return e.previewPostId||t})),Object(n.subscribe)((function(){if(!(e.postTypes.length<=0)){var t=Object(n.select)(be.dynamicSourcesStore).getDynamicSources(e.postTypes,e.previewPostId,e.random);if(t&&t.previewPostId){var r={},c={},i={};c[t.previewPostId]=e.maybeAppendPostProvidersForCustomPost(t.postProviders),r[t.previewPostId]=e.maybeAppendDynamicSourcesForCustomPost(t.dynamicSources),i[t.previewPostId]=e.maybeAppendCacheForCustomPost(t.cache),be.postProvidersForViews=Object(s.merge)(be.postProvidersForViews,c),be.dynamicSourcesForViews=Object(s.merge)(be.dynamicSourcesForViews,r);var a=!1,u=function(e){for(var t=1;t<arguments.length;t++){var r=null!=arguments[t]?arguments[t]:{};t%2?ae(r,!0).forEach((function(t){fe(e,t,r[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):ae(r).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(r,t))}))}return e}({},be.cacheForViews,{},i);JSON.stringify(u)!==JSON.stringify(be.cacheForViews)&&(a=!0,be.cacheForViews=u,e.viewStoreIds[t.previewPostId].forEach((function(e){Object(o.doAction)("toolset.views.updatePreview",e)}))),e.previewPostId,t.previewPostId,a&&Object(o.doAction)("tb.dynamicSources.actions.cache.tick")}}})),e}return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&pe(e,t)}(t,e),t}(U.Component),ve=function(e){switch(e.constructor){case Array:return e.length?e[0]:"";case Object:var t=Object.keys(e);return t.length?e[t[0]]:"";default:return e.toString()}};function he(e){return(he="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function Oe(e){return(Oe=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}function ge(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function we(e,t){return(we=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}function Se(e,t,r){return t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}var Pe=window.toolsetDynamicSourcesScriptData,je=function(e){function t(){var e,r,c,i;!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t);for(var a=arguments.length,s=new Array(a),u=0;u<a;u++)s[u]=arguments[u];return c=this,i=(e=Oe(t)).call.apply(e,[this].concat(s)),r=!i||"object"!==he(i)&&"function"!=typeof i?ge(c):i,Se(ge(r),"componentDidUpdate",(function(e){r.props.previewPost!==e.previewPost&&(Object(n.select)(Pe.dynamicSourcesStore).getCacheUpdating()||Object(o.doAction)("tb.dynamicSources.actions.cache.initiateFetching"))})),Se(ge(r),"render",(function(){return null})),r}return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&we(e,t)}(t,e),t}(U.Component),_e=Object(M.compose)([Object(n.withSelect)((function(e){return{previewPost:(0,e(Pe.dynamicSourcesStore).getPreviewPost)()}}))])(je);function Ce(e){return(Ce="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function Ee(){return(Ee=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var n in r)Object.prototype.hasOwnProperty.call(r,n)&&(e[n]=r[n])}return e}).apply(this,arguments)}function Re(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}function ke(e,t){return!t||"object"!==Ce(t)&&"function"!=typeof t?function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e):t}function De(e){return(De=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}function Fe(e,t){return(Fe=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}var Ae=Object(M.createHigherOrderComponent)((function(e){var t=function(t){function r(){return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,r),ke(this,De(r).apply(this,arguments))}var n,o,c;return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&Fe(e,t)}(r,t),n=r,(o=[{key:"render",value:function(){return React.createElement(U.Fragment,null,React.createElement(_e,Ee({},this.props.ownProps,this.mergeProps)),React.createElement(e,Ee({},this.props.ownProps,this.mergeProps)))}}])&&Re(n.prototype,o),c&&Re(n,c),r}(U.Component);return function(e){return React.createElement(t,{ownProps:e})}}),"withPostPreview");function Te(e){return(Te="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function Ie(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}function xe(e,t){return!t||"object"!==Te(t)&&"function"!=typeof t?function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e):t}function Ue(e){return(Ue=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}function Le(e,t){return(Le=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}var Me="tb-dynamic-container",Ne=function(e){function t(){return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t),xe(this,Ue(t).apply(this,arguments))}var r,n,o;return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&Le(e,t)}(t,e),r=t,(n=[{key:"filterUnusedDynamics",value:function(e){Array.isArray(e)||(e=[e]);var t=[];return e.map((function(e){e.source&&e.provider&&t.push(e)})),t}},{key:"getShortcodeStart",value:function(e){if(0===e.length)return"";var t="[".concat(Me),r=[],n=[],o=[],c=[];return e.map((function(e){e.customPost?r.push(e.customPost.value):r.push(e.provider),n.push(e.source),o.push(e.field?e.field:""),(e["default-value"]||0===e["default-value"])&&c.push(e["default-value"])})),t+=" provider='".concat(r.join("#+*#"),"'"),t+=" source='".concat(n.join("#+*#"),"'"),t+=" field='".concat(o.join("#+*#"),"'"),c.length&&(t+=" default-value='".concat(c.join("#+*#"),"'")),t+="]"}},{key:"getShortcodeEnd",value:function(e){return 0===e.length?"":"[/".concat(Me,"]")}},{key:"render",value:function(){var e=this.props,t=e.children,r=e.requiredDynamics,n=this.filterUnusedDynamics(r);return React.createElement(U.Fragment,null,this.getShortcodeStart(n),t,this.getShortcodeEnd(n))}}])&&Ie(r.prototype,n),o&&Ie(r,o),t}(U.Component);r(11);function Ve(e){return(Ve="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function Be(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}function We(e,t){return!t||"object"!==Ve(t)&&"function"!=typeof t?function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e):t}function Ge(e){return(Ge=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}function Ke(e,t){return(Ke=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}var He=function(e){function t(){return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t),We(this,Ge(t).apply(this,arguments))}var r,n,o;return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&Ke(e,t)}(t,e),r=t,(n=[{key:"render",value:function(){return React.createElement(U.Fragment,null,Object(c.__)("This content is coming from a Dynamic Source. Use the Settings Sidebar to change its source.","wpv-views"))}}])&&Be(r.prototype,n),o&&Be(r,o),t}(U.Component);function qe(e){return(qe="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function Ye(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}function Qe(e){return(Qe=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}function $e(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function Je(e,t){return(Je=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}function ze(e,t,r){return t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}var Xe=window.toolsetDynamicSourcesScriptData,Ze=function(e){function t(){var e,r,n,o;!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t);for(var i=arguments.length,a=new Array(i),s=0;s<i;s++)a[s]=arguments[s];return n=this,o=(e=Qe(t)).call.apply(e,[this].concat(a)),r=!o||"object"!==qe(o)&&"function"!=typeof o?$e(n):o,ze($e(r),"maybeRenderLoadingSpinner",(function(){var e=null;return r.props.loading&&(e=React.createElement(L.Spinner,{key:"tb-spinner"})),e})),ze($e(r),"renderOverlayWithSpiner",(function(){return React.createElement("div",{className:"tb-overlay wp-block-embed is-loading",key:"tb-overlay"},React.createElement(L.Spinner,null))})),ze($e(r),"renderEditWrapperContent",(function(){var e=[r.props.children];return r.props.loading&&e.push(r.renderOverlayWithSpiner()),React.createElement(U.Fragment,null,e)})),ze($e(r),"renderDynamicContentBreadcrumb",(function(){var e=r.props,t=e.isSelected,n=e.hasDynamicSource;if(t&&n)return React.createElement("div",{className:"editor-block-list__breadcrumb block-editor-block-list__breadcrumb"},React.createElement(L.Toolbar,null,React.createElement(U.Fragment,null,r.maybeRenderLoadingSpinner(),React.createElement("span",{className:"breadcrumb-label"},Object(c.__)("Dynamic Content","wpv-views")))))})),ze($e(r),"renderEditWrapper",(function(){var e=r.props.hasDynamicSource,t="wp-block-toolset-blocks-wrapper";return React.createElement("div",{className:e?"".concat(t," dynamic"):t},r.renderEditWrapperContent())})),r}var r,n,o;return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&Je(e,t)}(t,e),r=t,(n=[{key:"render",value:function(){var e=this.props,t=e.hasDynamicSource,r=e.disableTooltip,n=void 0!==r&&r,o=this.renderEditWrapper();return t&&!n&&(o=React.createElement(V.Tooltip,{text:React.createElement(He,null),trigger:"mouseenter focus click",maxWidth:"500"},o)),o}}])&&Ye(r.prototype,n),o&&Ye(r,o),t}(U.Component),et=Object(M.compose)([Object(n.withSelect)((function(e,t){return{loading:(0,e(Xe.dynamicSourcesStore).getLoading)(t.clientId)}}))])(Ze);function tt(e){return(tt="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function rt(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}function nt(e,t){return!t||"object"!==tt(t)&&"function"!=typeof t?function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e):t}function ot(e){return(ot=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}function ct(e,t){return(ct=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}var it=function(e){function t(){return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t),nt(this,ot(t).apply(this,arguments))}var r,n,o;return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&ct(e,t)}(t,e),r=t,(n=[{key:"render",value:function(){var e=this.props,t=e.hasDynamicSource,r=e.children;if(!t)return null;var n=React.createElement("div",{className:"tb-field__overlay"});return r&&(n=React.createElement("div",{className:"tb-field__overlay"},r)),React.createElement(V.Tooltip,{text:React.createElement(He,null),trigger:"mouseenter focus click",maxWidth:"500"},n)}}])&&rt(r.prototype,n),o&&rt(r,o),t}(U.Component);function at(e){return(at="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function st(e,t){return function(e){if(Array.isArray(e))return e}(e)||function(e,t){var r=[],n=!0,o=!1,c=void 0;try{for(var i,a=e[Symbol.iterator]();!(n=(i=a.next()).done)&&(r.push(i.value),!t||r.length!==t);n=!0);}catch(e){o=!0,c=e}finally{try{n||null==a.return||a.return()}finally{if(o)throw c}}return r}(e,t)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance")}()}function ut(e,t,r,n,o,c,i){try{var a=e[c](i),s=a.value}catch(e){return void r(e)}a.done?t(s):Promise.resolve(s).then(n,o)}function lt(e){return function(){var t=this,r=arguments;return new Promise((function(n,o){var c=e.apply(t,r);function i(e){ut(c,n,o,i,a,"next",e)}function a(e){ut(c,n,o,i,a,"throw",e)}i(void 0)}))}}function pt(){return(pt=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var n in r)Object.prototype.hasOwnProperty.call(r,n)&&(e[n]=r[n])}return e}).apply(this,arguments)}function ft(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),r.push.apply(r,n)}return r}function dt(e){for(var t=1;t<arguments.length;t++){var r=null!=arguments[t]?arguments[t]:{};t%2?ft(r,!0).forEach((function(t){ht(e,t,r[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):ft(r).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(r,t))}))}return e}function bt(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}function yt(e){return(yt=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}function mt(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function vt(e,t){return(vt=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}function ht(e,t,r){return t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}var Ot=window.toolsetDynamicSourcesScriptData,gt=function(e){function t(e){var r,n,i;return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t),n=this,i=yt(t).call(this,e),r=!i||"object"!==at(i)&&"function"!=typeof i?mt(n):i,ht(mt(r),"DEFAULT_POST_PROVIDER",null),ht(mt(r),"ungroupedSources",[]),ht(mt(r),"componentDidUpdate",(function(e){if(r.props.previewPost!==e.previewPost&&r.ungroupedSources.length&&r.props.dynamicSourcesEligibleAttribute.sourceObject){var t=Object(s.find)(r.ungroupedSources,{value:r.props.dynamicSourcesEligibleAttribute.sourceObject}),n=t.fields.length>0?Object(s.find)(t.fields,{value:r.props.dynamicSourcesEligibleAttribute.fieldObject}):null;r.dynamicSourceSelectChanged(t),r.dynamicSourceFieldSelectChanged(n)}})),ht(mt(r),"customStyles",{menu:function(e){return dt({},e,{position:"relative"})},input:function(e,t){return dt({},e,{"& input:focus":{boxShadow:(t.isFocused,"none !important")}})}}),ht(mt(r),"filterSources",(function(){var e=r.props,t=e.dynamicSourcesEligibleAttribute,n=e.postType,c=e.clientId,i=e.componentId,a="__custom_post"===t.postProviderObject&&t.customPostObject?t.customPostObject.value:t.postProviderObject||r.DEFAULT_POST_PROVIDER,u=Object(o.applyFilters)("tb.dynamicSources.filters.adjustSourcesForBlocksInsideViews",Ot.dynamicSources,c),l=i?Object(o.applyFilters)("tb.dynamicSources.filters.adjustSourcesForBlocks",u,i):u,p=Object(s.cloneDeep)(l[a]);return p.forEach((function(e){e.options=e.options.filter((function(e){var c=function(e,t){if(!t)return!0;var r=Array.isArray(t)?t:[t];return!e.filter((function(e){return r.includes(e)})).length},i=Object(o.applyFilters)("toolsetViews.filters.getParentViewBlock",null,r.props.clientId),a=Object(o.applyFilters)("toolsetViews.filters.getViewEditorBlockTypes",null);if("post-content"===e.value&&"view-template"!==n&&!Object(s.isUndefined)(a.BLOCK_ID_EDITOR)&&a.BLOCK_ID_EDITOR!==Object(s.get)(i,"name",null))return!1;if(r.ungroupedSources.push(e),Object(s.has)(e,"fields")&&!Object(s.isEmpty)(e.fields)){var u=Object(s.find)(e.fields,(function(e){return!!c(e.categories,t.bannedCategories)&&Object(s.includes)(e.categories,t.category)}));return!Object(s.isEmpty)(u)}return!!c(e.categories,t.bannedCategories)&&Object(s.includes)(e.categories,t.category)}))})),p})),ht(mt(r),"renderDynamicPostProviderSelect",(function(){var e=r.props,t=e.dynamicSourcesEligibleAttribute,n=e.clientId,i=r.props.hideLabels||!0;t.postProviderObject||t.selectPostProviderChangedCallback(r.DEFAULT_POST_PROVIDER);var a=Object(o.applyFilters)("tb.dynamicSources.filters.adjustProvidersForBlocksInsideViews",Ot.postProviders,n),u=Object(s.find)(a,{value:t.postProviderObject}),l=i?{placeholder:Object(c.__)("Select a Post Source","wpv-views")}:{};return React.createElement(U.Fragment,{key:"post-provider-select"},React.createElement(L.BaseControl,{label:!!i&&Object(c.__)("Post Source","wpv-views")},React.createElement(V.Select,pt({options:a,styles:r.customStyles},l,{value:u,onChange:function(e){t.selectPostProviderChangedCallback(e.value),t.selectCustomPostChangedCallback(null),t.selectSourceChangedCallback(null),t.selectFieldChangedCallback(null),t.sourceContentFetchedCallback("")}}))))})),ht(mt(r),"dynamicSourceSelectChanged",function(){var e=lt(regeneratorRuntime.mark((function e(t){var n,c,i,a,s,u,l,p,f,d;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(Object(o.doAction)("tb.dynamicSources.actions.source.changed",t),n=r.props.dynamicSourcesEligibleAttribute,c=null!==t?t.value:null,n.selectSourceChangedCallback(c),n.selectFieldChangedCallback(null),!t||0!==t.fields.length){e.next=15;break}return i=r.props,a=i.clientId,s=i.setLoading,u=i.post,l=i.previewPost,p=n.postProviderObject||r.DEFAULT_POST_PROVIDER,s(a,!0),f=Object(o.applyFilters)("tb.dynamicSources.filters.adjustPreviewPostID",l||u,a),e.next=12,r.fetchDynamicContent(p,f,c);case 12:null===(d=e.sent)?n.sourceContentFetchedCallback(""):n.sourceContentFetchedCallback(d),s(a,!1);case 15:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}()),ht(mt(r),"renderDynamicSourceSelect",(function(){var e=r.props.dynamicSourcesEligibleAttribute,t=r.props.hideLabels||!0,n=r.filterSources(),o=Object(s.find)(r.ungroupedSources,{value:e.sourceObject})||null;if("__custom_post"===e.postProviderObject&&!e.customPostObject)return null;var i=t?{placeholder:Object(c.__)("Select a Source","wpv-views")}:{};return React.createElement(U.Fragment,{key:"dynamic-source-select"},React.createElement(L.BaseControl,{label:!!t&&Object(c.__)("Source","wpv-views")},React.createElement(V.Select,pt({isClearable:!0,options:n,styles:r.customStyles},i,{value:o,onChange:r.dynamicSourceSelectChanged}))))})),ht(mt(r),"dynamicSourceFieldSelectChanged",function(){var e=lt(regeneratorRuntime.mark((function e(t){var n,c,i,a,s,u,l,p,f,d,b;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(Object(o.doAction)("tb.dynamicSources.actions.field.changed",t),n=r.props.dynamicSourcesEligibleAttribute,c=null!==t?t.value:null,n.selectFieldChangedCallback(c),!c){e.next=16;break}return i=r.props,a=i.clientId,s=i.setLoading,u=i.post,l=i.previewPost,s(a,!0),p=n.postProviderObject,f=n.sourceObject,n.sourceContentFetchedCallback(""),d=Object(o.applyFilters)("tb.dynamicSources.filters.adjustPreviewPostID",l||u,a),e.next=13,r.fetchDynamicContent(p,d,f,c);case 13:b=e.sent,n.sourceContentFetchedCallback(b),s(a,!1);case 16:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}()),ht(mt(r),"renderDynamicSourceSearchPost",(function(){var e=r.props.dynamicSourcesEligibleAttribute,t=r.props.hideLabels||!0;if("__custom_post"!==e.postProviderObject)return null;var n=t?{placeholder:Object(c.__)("Start typing to search...","wpv-views")}:{};return React.createElement(U.Fragment,{key:"dynamic-custom-post-select"},React.createElement(L.BaseControl,{label:!!t&&Object(c.__)("Post","wpv-views")},React.createElement(V.AsyncSelect,pt({isClearable:!0,defaultOptions:!0,cacheOptions:!0,loadOptions:v.bind(mt(r)),onChange:r.customPostSelectChanged,styles:r.customStyles},n,{value:e.customPostObject}))))})),ht(mt(r),"customPostSelectChanged",function(){var e=lt(regeneratorRuntime.mark((function e(t){var n;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return n=r.props.dynamicSourcesEligibleAttribute,e.next=3,r.loadSourceFromCustomPost(t);case 3:n.selectCustomPostChangedCallback(t),n.selectSourceChangedCallback(null),n.selectFieldChangedCallback(null),n.sourceContentFetchedCallback("");case 7:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}()),ht(mt(r),"renderDynamicSourceFieldsSelect",(function(){var e=r.props.dynamicSourcesEligibleAttribute,t=r.props.hideLabels||!0;if(e.sourceObject){var n=Object(s.find)(r.ungroupedSources,["value",e.sourceObject]),o=n?n.fields:[];if(o=Object(s.filter)(o,(function(t){return Object(s.includes)(t.categories,e.category)})),Object(s.isEmpty)(o))return;var i=1===Object.keys(o).length?o:null,a=["image","video","audio"].includes(e.category)?Object(s.find)(o,{value:e.fieldObject}):Object(s.find)(o,{value:e.fieldObject})||i;a&&a===i&&r.dynamicSourceFieldSelectChanged(a[0]);var u=t?{placeholder:Object(c.__)("Select a Field","wpv-views")}:{};return React.createElement(L.BaseControl,{label:!!t&&Object(c.__)("Field","wpv-views"),key:"dynamic-source-fields-select"},React.createElement(V.Select,pt({isClearable:!0,options:o,styles:r.customStyles},u,{value:a,onChange:r.dynamicSourceFieldSelectChanged})))}})),ht(mt(r),"renderDynamicSourcesInfoMessages",(function(){return Object.keys(r.state.infoMessageQueue).length<=0?null:Object.keys(r.state.infoMessageQueue).map((function(e){return React.createElement(L.Notice,{status:"info",key:e,isDismissible:!1},r.state.infoMessageQueue[e])}))})),ht(mt(r),"renderDynamicSourceSelectControls",(function(){if(r.props.dynamicSourcesEligibleAttribute.condition)return[r.renderDynamicPostProviderSelect(),r.renderDynamicSourceSearchPost(),r.renderDynamicSourceSelect(),r.renderDynamicSourceFieldsSelect()]})),ht(mt(r),"renderDynamicSourceToggleControl",(function(){var e=r.props.dynamicSourcesEligibleAttribute;return e.toggleHide||!1?null:React.createElement(L.ToggleControl,{label:e.label,checked:e.condition,onChange:e.toggleChangedCallback})})),ht(mt(r),"renderDynamicSourceControls",(function(){var e=r.props,t=e.clientId,n=e.dynamicSourcesEligibleAttribute,o=n.attributeKey?"-"+n.attributeKey:"";if(n)return React.createElement("div",{className:t+o},r.renderDynamicSourceToggleControl(),r.renderDynamicSourceSelectControls(),r.renderDynamicSourcesInfoMessages())})),r.DEFAULT_POST_PROVIDER=Ot.postProviders[0].value,r.state={infoMessageQueue:{}},Object(o.addAction)("tb.dynamicSources.actions.field.changed","toolset-blocks",(function(e){var t=r.state.infoMessageQueue;e&&"rfg"===e.type?t.rfg=React.createElement(U.Fragment,null,React.createElement("p",{dangerouslySetInnerHTML:{__html:Object(c.sprintf)(Object(c.__)("%1$s is a Repeating Field Group. If you want to display its fields here, put another View block into this Loop item and choose %1$s in the Content Selection step of the View wizard.","wpv-views"),"<strong>".concat(e.label,"</strong>"))}})):delete t.rfg,r.setState({infoMessageQueue:t})})),Object(o.addAction)("tb.dynamicSources.actions.dynamicSourceComponentDidMount","toolset-blocks",(function(e){if(e===r.props.clientId){var t=r.props.dynamicSourcesEligibleAttribute,n=Object(s.find)(r.ungroupedSources,{value:t.sourceObject})||null;if(n){Object(o.doAction)("tb.dynamicSources.actions.source.changed",n);var c=n.fields.length>0?Object(s.find)(n.fields,{value:t.fieldObject}):null;c&&Object(o.doAction)("tb.dynamicSources.actions.field.changed",c)}}})),r}var r,n,i,a,u;return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&vt(e,t)}(t,e),r=t,(n=[{key:"componentDidMount",value:function(){Object(o.doAction)("tb.dynamicSources.actions.dynamicSourceComponentDidMount",this.props.clientId)}},{key:"componentWillMount",value:(u=lt(regeneratorRuntime.mark((function e(){var t;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(!(t=this.props.dynamicSourcesEligibleAttribute).customPostObject||Ot.dynamicSources[t.customPostObject.value]){e.next=4;break}return e.next=4,this.loadSourceFromCustomPost(t.customPostObject);case 4:case"end":return e.stop()}}),e,this)}))),function(){return u.apply(this,arguments)})},{key:"loadSourceFromCustomPost",value:(a=lt(regeneratorRuntime.mark((function e(t){var r,n,o,c,i;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return r=this.props,n=r.clientId,o=r.dynamicSourcesEligibleAttribute,(c=r.setLoading)(n,!0),e.next=4,h(t);case 4:i=t.value,o.postProviderObject=i,c(n,!1);case 7:case"end":return e.stop()}}),e,this)}))),function(e){return a.apply(this,arguments)})},{key:"isCustomPostProvider",value:function(e){return e.match(/^custom_post_type\|[^\|]+\|\d+$/)||"__custom_post"===e}},{key:"fetchDynamicContent",value:function(e,t,r,n){var o=this.props.dynamicSourcesEligibleAttribute;if(!o.customPostObject)return y(e,t,r,n);var c=this.isCustomPostProvider(e),i=st((c?o.customPostObject.value:"").split("|"),2)[1],a=c?i:t,s=c?o.customPostObject.value:e;return y(s,a,r,n)}},{key:"render",value:function(){return this.renderDynamicSourceControls()}}])&&bt(r.prototype,n),i&&bt(r,i),t}(U.Component),wt=Object(M.compose)([Object(n.withSelect)((function(e){var t=e("core/editor"),r=t.getCurrentPostId,n=t.getCurrentPostType,o=e(Ot.dynamicSourcesStore).getPreviewPost;return{post:r(),postType:n(),previewPost:o()}})),Object(n.withDispatch)((function(e){var t=e("core/notices").createErrorNotice,r=e(Ot.dynamicSourcesStore);return{createErrorNotice:t,setLoading:r.setLoading,setPreviewPost:r.setPreviewPost}}))])(gt);function St(e){return(St="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function Pt(e,t){return function(e){if(Array.isArray(e))return e}(e)||function(e,t){var r=[],n=!0,o=!1,c=void 0;try{for(var i,a=e[Symbol.iterator]();!(n=(i=a.next()).done)&&(r.push(i.value),!t||r.length!==t);n=!0);}catch(e){o=!0,c=e}finally{try{n||null==a.return||a.return()}finally{if(o)throw c}}return r}(e,t)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance")}()}function jt(e,t,r,n,o,c,i){try{var a=e[c](i),s=a.value}catch(e){return void r(e)}a.done?t(s):Promise.resolve(s).then(n,o)}function _t(e){return function(){var t=this,r=arguments;return new Promise((function(n,o){var c=e.apply(t,r);function i(e){jt(c,n,o,i,a,"next",e)}function a(e){jt(c,n,o,i,a,"throw",e)}i(void 0)}))}}function Ct(){return(Ct=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var n in r)Object.prototype.hasOwnProperty.call(r,n)&&(e[n]=r[n])}return e}).apply(this,arguments)}function Et(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),r.push.apply(r,n)}return r}function Rt(e){for(var t=1;t<arguments.length;t++){var r=null!=arguments[t]?arguments[t]:{};t%2?Et(r,!0).forEach((function(t){Tt(e,t,r[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):Et(r).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(r,t))}))}return e}function kt(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}function Dt(e){return(Dt=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}function Ft(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function At(e,t){return(At=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}function Tt(e,t,r){return t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}var It=window.toolsetDynamicSourcesScriptData,xt=function(e){function t(e){var r,n,i;!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t),n=this,i=Dt(t).call(this,e),r=!i||"object"!==St(i)&&"function"!=typeof i?Ft(n):i,Tt(Ft(r),"DEFAULT_POST_PROVIDER",null),Tt(Ft(r),"ungroupedSources",[]),Tt(Ft(r),"componentDidUpdate",(function(e,t){if(r.props.previewPost!==e.previewPost&&r.ungroupedSources.length&&r.props.dynamicSourcesEligibleAttribute.sourceObject){var n=Object(s.find)(r.ungroupedSources,{value:r.props.dynamicSourcesEligibleAttribute.sourceObject}),o=n.fields.length>0?Object(s.find)(n.fields,{value:r.props.dynamicSourcesEligibleAttribute.fieldObject}):null;r.dynamicSourceSelectChanged(n),r.dynamicSourceFieldSelectChanged(o)}t.postProvider===r.state.postProvider&&t.source===r.state.source&&t.field===r.state.field||(r.state.customPost&&!It.dynamicSources[r.state.customPost.value]&&r.loadSourceFromCustomPost(r.state.customPost),r.state.postProvider&&r.state.source&&r.state.field?(r.props.dynamicSourcesEligibleAttribute.fieldSelectedCallback({postProvider:r.state.postProvider,source:r.state.source,field:r.state.field,customPost:r.state.customPost}),r.setState({fieldWasSelected:!0})):r.state.postProvider&&r.state.source&&!r.state.source.includes("|")?(r.props.dynamicSourcesEligibleAttribute.fieldSelectedCallback({postProvider:r.state.postProvider,source:r.state.source,field:null,customPost:r.state.customPost}),r.setState({fieldWasSelected:!0})):r.state.fieldWasSelected&&(r.props.dynamicSourcesEligibleAttribute.fieldSelectedCallback(null),r.setState({fieldWasSelected:!1})))})),Tt(Ft(r),"customStyles",{menu:function(e){return Rt({},e,{position:"relative"})},input:function(e,t){return Rt({},e,{"& input:focus":{boxShadow:(t.isFocused,"none !important")}})}}),Tt(Ft(r),"filterSources",(function(){var e=r.props,t=e.dynamicSourcesEligibleAttribute,n=e.postType,c=e.clientId,i=e.componentId,a="__custom_post"===r.state.postProvider&&r.state.customPost?r.state.customPost.value:r.state.postProvider||r.DEFAULT_POST_PROVIDER,u=Object(o.applyFilters)("tb.dynamicSources.filters.adjustSourcesForBlocksInsideViews",It.dynamicSources,c),l=i?Object(o.applyFilters)("tb.dynamicSources.filters.adjustSourcesForBlocks",u,i):u,p=Object(s.cloneDeep)(l[a]);return p?(p.forEach((function(e){e.options=e.options.filter((function(e){var c=function(e,t){if(!t)return!0;var r=Array.isArray(t)?t:[t];return!e.filter((function(e){return r.includes(e)})).length},i=Object(o.applyFilters)("toolsetViews.filters.getParentViewBlock",null,r.props.clientId),a=Object(o.applyFilters)("toolsetViews.filters.getViewEditorBlockTypes",null);if("post-content"===e.value&&"view-template"!==n&&!Object(s.isUndefined)(a.BLOCK_ID_EDITOR)&&a.BLOCK_ID_EDITOR!==Object(s.get)(i,"name",null))return!1;if(r.ungroupedSources.push(e),Object(s.has)(e,"fields")&&!Object(s.isEmpty)(e.fields)){var u=Object(s.find)(e.fields,(function(e){return!!c(e.categories,t.bannedCategories)&&Object(s.includes)(e.categories,t.category)}));return!Object(s.isEmpty)(u)}return!!c(e.categories,t.bannedCategories)&&Object(s.includes)(e.categories,t.category)}))})),p):[]})),Tt(Ft(r),"renderDynamicPostProviderSelect",(function(){var e=r.props.clientId,t=r.props.hideLabels||!0;r.state.postProvider||r.setState({postProvider:r.DEFAULT_POST_PROVIDER});var n=Object(o.applyFilters)("tb.dynamicSources.filters.adjustProvidersForBlocksInsideViews",It.postProviders,e),i=Object(s.find)(n,{value:r.state.postProvider}),a=t?{placeholder:Object(c.__)("Select a Post Source","wpv-views")}:{};return React.createElement(U.Fragment,{key:"post-provider-select"},React.createElement(L.BaseControl,{label:!!t&&Object(c.__)("Post Source","wpv-views")},React.createElement(V.Select,Ct({options:n,styles:r.customStyles},a,{value:i,onChange:function(e){return r.setState({postProvider:e.value,customPost:null,source:null,field:null})}}))))})),Tt(Ft(r),"dynamicSourceSelectChanged",function(){var e=_t(regeneratorRuntime.mark((function e(t){var n;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:Object(o.doAction)("tb.dynamicSources.actions.source.changed",t),n=null!==t?t.value:null,r.setState({source:n,field:null});case 3:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}()),Tt(Ft(r),"renderDynamicSourceSelect",(function(){var e=r.props.hideLabels||!0,t=r.filterSources(),n=Object(s.find)(r.ungroupedSources,{value:r.state.source})||null;if("__custom_post"===r.state.postProvider&&!r.state.customPost)return null;var o=e?{placeholder:Object(c.__)("Select a Source","wpv-views")}:{};return React.createElement(U.Fragment,{key:"dynamic-source-select"},React.createElement(L.BaseControl,{label:!!e&&Object(c.__)("Source","wpv-views")},React.createElement(V.Select,Ct({isClearable:!0,options:t,styles:r.customStyles},o,{value:n,onChange:r.dynamicSourceSelectChanged}))))})),Tt(Ft(r),"dynamicSourceFieldSelectChanged",function(){var e=_t(regeneratorRuntime.mark((function e(t){var n;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:Object(o.doAction)("tb.dynamicSources.actions.field.changed",t),n=null!==t?t.value:null,r.setState({field:n});case 3:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}()),Tt(Ft(r),"renderDynamicSourceSearchPost",(function(){var e=r.props.hideLabels||!0;if("__custom_post"!==r.state.postProvider)return null;var t=e?{placeholder:Object(c.__)("Start typing to search...","wpv-views")}:{};return React.createElement(U.Fragment,{key:"dynamic-custom-post-select"},React.createElement(L.BaseControl,{label:!!e&&Object(c.__)("Post","wpv-views")},React.createElement(V.AsyncSelect,Ct({isClearable:!0,defaultOptions:!0,cacheOptions:!0,loadOptions:v.bind(Ft(r)),onChange:r.customPostSelectChanged,styles:r.customStyles},t,{value:r.state.customPost}))))})),Tt(Ft(r),"customPostSelectChanged",function(){var e=_t(regeneratorRuntime.mark((function e(t){return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,r.loadSourceFromCustomPost(t);case 2:r.setState({customPost:t,source:null,field:null});case 3:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}()),Tt(Ft(r),"renderDynamicSourceFieldsSelect",(function(){var e=r.props.dynamicSourcesEligibleAttribute,t=r.props.hideLabels||!0;if(r.state.source){var n=Object(s.find)(r.ungroupedSources,["value",r.state.source]),o=n?n.fields:[];if(o=Object(s.filter)(o,(function(t){return Object(s.includes)(t.categories,e.category)})),Object(s.isEmpty)(o))return;var i=1===Object.keys(o).length?o:null,a=["image","video","audio"].includes(e.category)?Object(s.find)(o,{value:r.state.field}):Object(s.find)(o,{value:r.state.field})||i;a&&a===i&&r.dynamicSourceFieldSelectChanged(a[0]);var u=t?{placeholder:Object(c.__)("Select a Field","wpv-views")}:{};return React.createElement(L.BaseControl,{label:!!t&&Object(c.__)("Field","wpv-views"),key:"dynamic-source-fields-select"},React.createElement(V.Select,Ct({isClearable:!0,options:o,styles:r.customStyles},u,{value:a,onChange:r.dynamicSourceFieldSelectChanged})))}})),Tt(Ft(r),"renderDynamicSourcesInfoMessages",(function(){return Object.keys(r.state.infoMessageQueue).length<=0?null:Object.keys(r.state.infoMessageQueue).map((function(e){return React.createElement(L.Notice,{status:"info",key:e,isDismissible:!1},r.state.infoMessageQueue[e])}))})),Tt(Ft(r),"renderDynamicSourceSelectControls",(function(){if(r.props.dynamicSourcesEligibleAttribute.condition)return[r.renderDynamicPostProviderSelect(),r.renderDynamicSourceSearchPost(),r.renderDynamicSourceSelect(),r.renderDynamicSourceFieldsSelect()]})),Tt(Ft(r),"renderDynamicSourceToggleControl",(function(){var e=r.props.dynamicSourcesEligibleAttribute;return e.toggleHide||!1?null:React.createElement(L.ToggleControl,{label:e.label,checked:e.condition,onChange:e.toggleChangedCallback})})),Tt(Ft(r),"renderDynamicSourceControls",(function(){var e=r.props,t=e.clientId,n=e.dynamicSourcesEligibleAttribute,o=n.attributeKey?"-"+n.attributeKey:"";if(n)return React.createElement("div",{className:t+o},r.renderDynamicSourceToggleControl(),r.renderDynamicSourceSelectControls(),r.renderDynamicSourcesInfoMessages())})),r.DEFAULT_POST_PROVIDER=It.postProviders[0].value;var a=e.dynamicSourcesEligibleAttribute,u=a.postProvider,l=a.source,p=a.field,f=a.customPost,d=Boolean(u&&l&&p);return r.state={infoMessageQueue:{},postProvider:u,customPost:f,source:l,field:p,fieldWasSelected:d},Object(o.addAction)("tb.dynamicSources.actions.dynamicSourceComponentDidMount","toolset-blocks",(function(e){if(e===r.props.clientId){var t=r.props.dynamicSourcesEligibleAttribute,n=Object(s.find)(r.ungroupedSources,{value:t.sourceObject})||null;if(n){Object(o.doAction)("tb.dynamicSources.actions.source.changed",n);var c=n.fields.length>0?Object(s.find)(n.fields,{value:t.fieldObject}):null;c&&Object(o.doAction)("tb.dynamicSources.actions.field.changed",c)}}})),r}var r,n,i,a;return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&At(e,t)}(t,e),r=t,(n=[{key:"componentDidMount",value:function(){var e=this;Object(o.addAction)("tb.dynamicSources.actions.field.changed","toolset-blocks",(function(t){var r=e.state.infoMessageQueue;t&&"rfg"===t.type?r.rfg=React.createElement(U.Fragment,null,React.createElement("p",{dangerouslySetInnerHTML:{__html:Object(c.sprintf)(Object(c.__)("%1$s is a Repeating Field Group. If you want to display its fields here, put another View block into this Loop item and choose %1$s in the Content Selection step of the View wizard.","wpv-views"),"<strong>".concat(t.label,"</strong>"))}})):delete r.rfg,e.setState({infoMessageQueue:r})})),Object(o.doAction)("tb.dynamicSources.actions.dynamicSourceComponentDidMount",this.props.clientId),this.state.customPost&&!It.dynamicSources[this.state.customPost.value]&&this.loadSourceFromCustomPost(this.state.customPost)}},{key:"loadSourceFromCustomPost",value:(a=_t(regeneratorRuntime.mark((function e(t){var r;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,h(t);case 2:r=t.value,this.setState({postProvider:r});case 4:case"end":return e.stop()}}),e,this)}))),function(e){return a.apply(this,arguments)})},{key:"isCustomPostProvider",value:function(e){return e.match(/^custom_post_type\|[^\|]+\|\d+$/)||"__custom_post"===e}},{key:"fetchDynamicContent",value:function(e,t,r,n){if(!this.state.customPost)return y(e,t,r,n);var o=this.isCustomPostProvider(e),c=Pt((o?this.state.customPost.value:"").split("|"),2)[1],i=o?c:t,a=o?this.state.customPost.value:e;return y(a,i,r,n)}},{key:"render",value:function(){return this.renderDynamicSourceControls()}}])&&kt(r.prototype,n),i&&kt(r,i),t}(U.Component),Ut=Object(M.compose)([Object(n.withSelect)((function(e){var t=e("core/editor"),r=t.getCurrentPostId,n=t.getCurrentPostType,o=e(It.dynamicSourcesStore).getPreviewPost;return{post:r(),postType:n(),previewPost:o()}})),Object(n.withDispatch)((function(e){var t=e("core/notices").createErrorNotice,r=e(It.dynamicSourcesStore);return{createErrorNotice:t,setLoading:r.setLoading,setPreviewPost:r.setPreviewPost}}))])(xt);function Lt(){return(Lt=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var n in r)Object.prototype.hasOwnProperty.call(r,n)&&(e[n]=r[n])}return e}).apply(this,arguments)}function Mt(e,t,r,n,o,c,i){try{var a=e[c](i),s=a.value}catch(e){return void r(e)}a.done?t(s):Promise.resolve(s).then(n,o)}function Nt(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),r.push.apply(r,n)}return r}function Vt(e){for(var t=1;t<arguments.length;t++){var r=null!=arguments[t]?arguments[t]:{};t%2?Nt(r,!0).forEach((function(t){Bt(e,t,r[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):Nt(r).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(r,t))}))}return e}function Bt(e,t,r){return t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function Wt(e){return(Wt="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function Gt(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}function Kt(e){return(Kt=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}function Ht(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function qt(e,t){return(qt=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}var Yt={isActive:!1,provider:null,source:null,customPost:null,field:null},Qt=Object(M.createHigherOrderComponent)((function(e){return function(t){function r(){var e,t,o;return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,r),t=this,(e=!(o=Kt(r).apply(this,arguments))||"object"!==Wt(o)&&"function"!=typeof o?Ht(t):o).dynamicFieldsRegister=e.dynamicFieldsRegister.bind(Ht(e)),e.dynamicFieldControlRender=e.dynamicFieldControlRender.bind(Ht(e)),e.dynamicFieldGet=e.dynamicFieldGet.bind(Ht(e)),e.dynamicFieldReset=e.dynamicFieldReset.bind(Ht(e)),e.dynamicFieldNoDataRender=e.dynamicFieldNoDataRender.bind(Ht(e)),e.requestUpdateContent=e.requestUpdateContent.bind(Ht(e)),e.requestFieldToggle=e.requestFieldToggle.bind(Ht(e)),e.requestFieldAttributeUpdate=e.requestFieldAttributeUpdate.bind(Ht(e)),e.doFieldsAttributeUpdate=e.doFieldsAttributeUpdate.bind(Ht(e)),e.currentPostId=Object(n.select)("core/editor").getCurrentPostId(),e.updateContentDebounce=null,e.attributesUpdateRequired=!1,e}var i,a,u;return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&qt(e,t)}(r,t),i=r,(a=[{key:"componentDidMount",value:function(){this.requestUpdateContent(),Object(o.addAction)("tb.dynamicSources.actions.cache.updated","toolset-blocks",this.requestUpdateContent)}},{key:"componentWillUnmount",value:function(){Object(o.removeAction)("tb.dynamicSources.actions.cache.updated","toolset-blocks",this.requestUpdateContent)}},{key:"dynamicFieldsRegister",value:function(e){var t=this,r=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"dynamic";"object"===Wt(e)?this.fields?Object.keys(this.fields).toString()!==Object.keys(e).toString()&&this.throwError("dynamicFieldsRegister() is called twice. Register all fields with one call."):(this.dynamicRootAttributeKey=r,this.fields={},Object.keys(e).forEach((function(n){e[n].attributeKey=e[n].attributeKey||n,t.fields[n]=Vt({},Yt,{},t.props.attributes[r]&&t.props.attributes[r][n]?t.props.attributes[r][n]:{},{},e[n])}))):this.throwError("dynamicFieldsRegister() first parameter must be an object.")}},{key:"dynamicFieldControlRender",value:function(e){if(this.fieldExists(e))return React.createElement(Ut,{clientId:this.props.clientId,dynamicSourcesEligibleAttribute:this.getFieldControlSetup(this.fields[e])})}},{key:"dynamicFieldGet",value:function(e){return this.fieldExists(e)?this.fields[e]:Yt}},{key:"dynamicFieldReset",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:null;this.fieldExists(e)&&this.requestFieldAttributeUpdate(this.fields[e],null,t)}},{key:"dynamicFieldNoDataRender",value:function(e){if(this.fieldExists(e)){var t=this.fields[e];return!this.props.attributes[t.attributeKey]&&t.isActive&&t.source?React.createElement("span",{style:{color:"#ccc"}},Object(c.__)("This dynamic source returned no content.","wpv-views")):null}}},{key:"fieldExists",value:function(e){return"string"!=typeof e?(this.throwError("First parameter must be a string"),!1):!(!this.fields||!this.fields[e])||(this.throwError('The requested field "'.concat(e,'" is not registered.')),!1)}},{key:"getFieldControlSetup",value:function(e){var t=this,r=e.label||Object(c.__)("Dynamic Source","wpv-views");return{attributeKey:e.attributeKey,label:r,condition:e.condition||e.isActive,postProvider:e.provider,source:e.source,field:e.field,customPost:e.customPost,toggleHide:e.toggleHide||!1,toggleChangedCallback:function(){t.requestFieldToggle(e)},fieldSelectedCallback:function(r){t.requestFieldAttributeUpdate(e,r)},category:e.category||"text",bannedCategories:e.bannedCategories||[]}}},{key:"updateFieldContent",value:function(e,t){var r=arguments.length>2&&void 0!==arguments[2]&&arguments[2],n=arguments.length>3&&void 0!==arguments[3]?arguments[3]:null;if(t&&e.customContentCallback){if("function"==typeof e.customContentCallback)return e.customContentCallback(t,this.props.attributes,n),!1;this.throwError("customContentCallback must be a function.")}else{var o=t&&t.sourceContent?ve(t.sourceContent):"";if(e.parse)switch(e.parse){case"int":o=parseInt(o);break;case"float":o=parseFloat(o)}if(r)return Bt({},e.attributeKey,o);this.props.setAttributes(Bt({},e.attributeKey,o))}}},{key:"requestFieldToggle",value:function(e){this.fields[e.attributeKey].isActive=!this.fields[e.attributeKey].isActive,this.attributesUpdateRequired=!0,this.doFieldsAttributeUpdate(),this.fields[e.attributeKey].isActive&&this.requestUpdateContent()}},{key:"requestFieldAttributeUpdate",value:function(e,t){var r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:null;null===r&&e.toggleHide&&(this.fields[e.attributeKey].isActive=!0),null!==r&&(this.fields[e.attributeKey].isActive=!!r),null===t?(this.fields[e.attributeKey].customPost=null,this.fields[e.attributeKey].field=null,this.fields[e.attributeKey].provider=null,this.fields[e.attributeKey].source=null):(this.fields[e.attributeKey].customPost=t.customPost,this.fields[e.attributeKey].field=t.field,this.fields[e.attributeKey].provider=t.postProvider,this.fields[e.attributeKey].source=t.source),this.attributesUpdateRequired=!0,this.doFieldsAttributeUpdate(),this.requestUpdateContent()}},{key:"doFieldsAttributeUpdate",value:function(){var e=this,t={};this.attributesUpdateRequired&&(this.attributesUpdateRequired=!1,Object.keys(this.fields).forEach((function(r){var n=function(e,t){if(void 0===t)return{};var r=Object(s.reduce)(e,(function(e,r,n){return Object(s.isEqual)(r,t[n])?e:e.concat(n)}),[]),n={};return r.forEach((function(e){n[e]=t[e]})),n}(Yt,e.fields[r]);Object.keys(n).length>0&&(t[r]=n)})),this.props.setAttributes(Bt({},this.dynamicRootAttributeKey,t)))}},{key:"requestUpdateContent",value:function(){var e=this,t=this.currentPostId,r=this.props,c=r.setAttributes,i=r.clientId,a=window.toolsetDynamicSourcesScriptData,s=Object(o.applyFilters)("tb.dynamicSources.filters.adjustPreviewPostID",Object(n.select)(a.dynamicSourcesStore).getPreviewPost(),i)||t;Object.keys(this.fields).map(function(){var t,r=(t=regeneratorRuntime.mark((function t(r){var n,o,i,a,u,l,p,f,d;return regeneratorRuntime.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if(n=e.fields[r],o=n.isActive,i=n.source,a=n.field,u=n.provider,l=n.customPost,o){t.next=3;break}return t.abrupt("return");case 3:return p=l?l.value:u,t.next=6,y(p,s,i,a||null);case 6:f=t.sent,!1!==(d=e.updateFieldContent(e.fields[r],f,!0,i))&&c(d);case 9:case"end":return t.stop()}}),t)})),function(){var e=this,r=arguments;return new Promise((function(n,o){var c=t.apply(e,r);function i(e){Mt(c,n,o,i,a,"next",e)}function a(e){Mt(c,n,o,i,a,"throw",e)}i(void 0)}))});return function(e){return r.apply(this,arguments)}}())}},{key:"throwError",value:function(e){console.error("[withToolsetDynamicField] ".concat(e))}},{key:"render",value:function(){return React.createElement(U.Fragment,null,React.createElement(_e,this.props),React.createElement(e,Lt({},this.props,{dynamicFieldsRegister:this.dynamicFieldsRegister,dynamicFieldControlRender:this.dynamicFieldControlRender,dynamicFieldNoDataRender:this.dynamicFieldNoDataRender,dynamicFieldGet:this.dynamicFieldGet,dynamicFieldReset:this.dynamicFieldReset})))}}])&&Gt(i.prototype,a),u&&Gt(i,u),r}(U.Component)}),"withToolsetDynamicField");function $t(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),r.push.apply(r,n)}return r}function Jt(e,t,r){return t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function zt(e,t,r,n){var o=arguments.length>4&&void 0!==arguments[4]?arguments[4]:"",c=arguments.length>5&&void 0!==arguments[5]?arguments[5]:"current",i=arguments.length>6&&void 0!==arguments[6]&&arguments[6],a=arguments.length>7&&void 0!==arguments[7]?arguments[7]:{};if(e&&t){var s=function(e){for(var t=1;t<arguments.length;t++){var r=null!=arguments[t]?arguments[t]:{};t%2?$t(r,!0).forEach((function(t){Jt(e,t,r[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):$t(r).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(r,t))}))}return e}({provider:n,post:c,source:t},a),u="[tb-dynamic";return Object.keys(s).forEach((function(e){u+=" ".concat(e,"='").concat(s[e],"'")})),r&&(u+=" field='".concat(r,"'")),i&&(u+=" force-string='".concat(i,"' ")),u+="]"}return o}var Xt=function(e,t){var r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{};if(!e||!e.isActive||!e.source)return t;var n=r.post||"current",o=r.repeatableFieldShowOnly||!1,c=r.extraAttributes||{},i=e.customPost?e.customPost.value:e.provider;return zt(e.isActive,e.source,e.field,i,t,n,o,c)};function Zt(e){return(Zt="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function er(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),r.push.apply(r,n)}return r}function tr(e){for(var t=1;t<arguments.length;t++){var r=null!=arguments[t]?arguments[t]:{};t%2?er(r,!0).forEach((function(t){ir(e,t,r[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):er(r).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(r,t))}))}return e}function rr(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}function nr(e){return(nr=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}function or(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function cr(e,t){return(cr=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}function ir(e,t,r){return t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}var ar=function(e){function t(e){var r,n,o;!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t),n=this,o=nr(t).call(this,e),r=!o||"object"!==Zt(o)&&"function"!=typeof o?or(n):o,ir(or(r),"COUNTBY_CHAR","char"),ir(or(r),"COUNTBY_WORD","word"),ir(or(r),"makeExcerpt",(function(e){var t=tr({},r.state,{},e),n="";return n=t.countBy===r.COUNTBY_CHAR?r.props.content.substring(0,t.length):r.props.content.split(" ").splice(0,t.length).join(" "),t.renderEllipsis&&n.length<r.props.content.length&&0!==n.length&&(n+=t.ellipsisText),n})),ir(or(r),"modifyContent",(function(e){var t=r.props.onModifyContent;"countBy"in e&&(e.countBy===r.COUNTBY_WORD?e.maxLength=r.props.content.split(" ").length:e.maxLength=r.props.content.length,e.maxLength<r.state.length&&(e.length=e.maxLength)),r.setState(e);var n=tr({},r.state,{},e);t({content:r.makeExcerpt(e),shortcodeAttributes:n})}));var i={length:e.content?30:0,maxLength:e.content?e.content.split(" ").length:0,countBy:r.COUNTBY_WORD,renderEllipsis:!0,ellipsisText:Object(c.__)("...","wpv-views")};return r.state=e.modifiedContent?tr({},i,{},e.modifiedContent.shortcodeAttributes):i,r}var r,n,o;return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&cr(e,t)}(t,e),r=t,(n=[{key:"componentDidUpdate",value:function(e){var t=this.props;null===e.content&&null!==t.content&&this.modifyContent({length:t.content?30:0,maxLength:t.content?t.content.split(" ").length:0})}},{key:"render",value:function(){var e=this,t=this.state,r=t.length,n=t.maxLength,o=t.countBy,i=t.renderEllipsis,a=t.ellipsisText;return React.createElement(U.Fragment,null,React.createElement(L.RangeControl,{label:Object(c.__)("Length","wpv-views"),value:r,onChange:function(t){return e.modifyContent({length:t})},min:0,max:n}),React.createElement(L.RadioControl,{label:Object(c.__)("Count Length By","wpv-views"),selected:o,options:[{label:Object(c.__)("Characters","wpv-views"),value:this.COUNTBY_CHAR},{label:Object(c.__)("Words","wpv-views"),value:this.COUNTBY_WORD}],onChange:function(t){return e.modifyContent({countBy:t})}}),React.createElement(L.ToggleControl,{label:Object(c.__)("Show Ellipsis","wpv-views"),checked:i,onChange:function(){return e.modifyContent({renderEllipsis:!i})}}),i&&React.createElement(L.TextControl,{label:Object(c.__)("Ellipsis Text","wpv-views"),value:a,onChange:function(t){return e.modifyContent({ellipsisText:t})}}))}}])&&rr(r.prototype,n),o&&rr(r,o),t}(U.Component),sr=Object(M.pure)(ar,"Excerpt");function ur(e){return(ur="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function lr(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),r.push.apply(r,n)}return r}function pr(e,t,r,n,o,c,i){try{var a=e[c](i),s=a.value}catch(e){return void r(e)}a.done?t(s):Promise.resolve(s).then(n,o)}function fr(e){return function(){var t=this,r=arguments;return new Promise((function(n,o){var c=e.apply(t,r);function i(e){pr(c,n,o,i,a,"next",e)}function a(e){pr(c,n,o,i,a,"throw",e)}i(void 0)}))}}function dr(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}function br(e){return(br=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}function yr(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function mr(e,t){return(mr=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}function vr(e,t,r){return t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}var hr=function(e){function t(e){var r,n,o;!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t),n=this,o=br(t).call(this,e),r=!o||"object"!==ur(o)&&"function"!=typeof o?yr(n):o,vr(yr(r),"FORMAT_NAME","name"),vr(yr(r),"FORMAT_LINK","link"),vr(yr(r),"FORMAT_URL","url"),vr(yr(r),"FORMAT_DESCRIPTION","description"),vr(yr(r),"FORMAT_SLUG","slug"),vr(yr(r),"FORMAT_COUNT","count"),vr(yr(r),"SHOW_NAME","name"),vr(yr(r),"SHOW_DESCRIPTION","description"),vr(yr(r),"SHOW_SLUG","slug"),vr(yr(r),"SHOW_COUNT","count"),vr(yr(r),"ORDER_ASC","asc"),vr(yr(r),"ORDER_DESC","desc"),vr(yr(r),"makeTagLink",(function(e,t){return'<a href="//?tag='.concat(e,'">').concat(t,"</a>")})),vr(yr(r),"getOrigin",(function(){return new URL(window.location.href).origin})),vr(yr(r),"formatTaxonomy",fr(regeneratorRuntime.mark((function e(){var t,n,o,c,i,a,s;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(t=r.state,n=t.separator,o=t.format,c=t.show,i=t.order,a=Array.isArray(r.props.content)?r.props.content:r.props.content.split(","),o===r.FORMAT_NAME){e.next=8;break}return e.next=6,y(r.props.postProvider,r.props.postId,"post-taxonomies-rich",r.props.postField.value);case 6:s=e.sent,a=s.sourceContent;case 8:e.t0=o,e.next=e.t0===r.FORMAT_LINK?11:e.t0===r.FORMAT_URL?23:e.t0===r.FORMAT_COUNT?25:e.t0===r.FORMAT_SLUG?27:e.t0===r.FORMAT_DESCRIPTION?29:(e.t0,r.FORMAT_NAME,31);break;case 11:e.t1=c,e.next=e.t1===r.SHOW_NAME?14:e.t1===r.SHOW_DESCRIPTION?16:e.t1===r.SHOW_SLUG?18:e.t1===r.SHOW_COUNT?20:22;break;case 14:return a=a.map((function(e){return r.makeTagLink(e.slug,e.name)})),e.abrupt("break",22);case 16:return a=a.map((function(e){return r.makeTagLink(e.slug,e.description)})),e.abrupt("break",22);case 18:return a=a.map((function(e){return r.makeTagLink(e.slug,e.slug)})),e.abrupt("break",22);case 20:return a=a.map((function(e){return r.makeTagLink(e.slug,e.count)})),e.abrupt("break",22);case 22:return e.abrupt("break",32);case 23:return a=a.map((function(e){return"".concat(r.getOrigin(),"/?tag=").concat(e.slug)})),e.abrupt("break",32);case 25:return a=a.map((function(e){return e.count})),e.abrupt("break",32);case 27:return a=a.map((function(e){return e.slug})),e.abrupt("break",32);case 29:return a=a.map((function(e){return e.description})),e.abrupt("break",32);case 31:return e.abrupt("break",32);case 32:return i===r.ORDER_DESC&&(a=a.reverse()),e.abrupt("return",a.join(n));case 34:case"end":return e.stop()}}),e)})))),vr(yr(r),"modifyContent",function(){var e=fr(regeneratorRuntime.mark((function e(t){var n;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return n=r.props.onModifyContent,e.next=3,r.setState(t);case 3:return e.t0=n,e.next=6,r.formatTaxonomy();case 6:e.t1=e.sent,e.t2=r.state,e.t3={content:e.t1,shortcodeAttributes:e.t2},(0,e.t0)(e.t3);case 10:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}());var c={separator:", ",format:r.FORMAT_NAME,show:r.SHOW_NAME,order:r.ORDER_ASC};return r.state=e.modifiedContent?function(e){for(var t=1;t<arguments.length;t++){var r=null!=arguments[t]?arguments[t]:{};t%2?lr(r,!0).forEach((function(t){vr(e,t,r[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):lr(r).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(r,t))}))}return e}({},c,{},e.modifiedContent.shortcodeAttributes):c,r}var r,n,o;return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&mr(e,t)}(t,e),r=t,(n=[{key:"componentDidMount",value:function(){this.modifyContent({})}},{key:"render",value:function(){var e=this,t=this.state,r=t.separator,n=t.format,o=t.show,i=t.order;return React.createElement(U.Fragment,null,React.createElement(L.RadioControl,{label:Object(c.__)("Display Format","wpv-views"),selected:n,options:[{label:Object(c.__)("Link to term archive page","wpv-views"),value:this.FORMAT_LINK},{label:Object(c.__)("URL of term archive page","wpv-views"),value:this.FORMAT_URL},{label:Object(c.__)("Term name","wpv-views"),value:this.FORMAT_NAME},{label:Object(c.__)("Term description","wpv-views"),value:this.FORMAT_DESCRIPTION},{label:Object(c.__)("Term slug","wpv-views"),value:this.FORMAT_SLUG},{label:Object(c.__)("Term post count","wpv-views"),value:this.FORMAT_COUNT}],onChange:function(t){return e.modifyContent({format:t})}}),n===this.FORMAT_LINK&&React.createElement(L.RadioControl,{label:Object(c.__)("Anchor Text When Linking to the Term Archive Page","wpv-views"),selected:o,options:[{label:Object(c.__)("Term name","wpv-views"),value:this.SHOW_NAME},{label:Object(c.__)("Term description","wpv-views"),value:this.SHOW_DESCRIPTION},{label:Object(c.__)("Term slug","wpv-views"),value:this.SHOW_SLUG},{label:Object(c.__)("Term post count","wpv-views"),value:this.SHOW_COUNT}],onChange:function(t){return e.modifyContent({show:t})}}),React.createElement(L.TextControl,{label:Object(c.__)("Separator Between Terms","wpv-views"),value:r,onChange:function(t){return e.modifyContent({separator:t})}}),React.createElement(L.RadioControl,{label:Object(c.__)("Order","wpv-views"),selected:i,options:[{label:Object(c.__)("Ascending","wpv-views"),value:this.ORDER_ASC},{label:Object(c.__)("Descending","wpv-views"),value:this.ORDER_DESC}],onChange:function(t){return e.modifyContent({order:t})}}))}}])&&dr(r.prototype,n),o&&dr(r,o),t}(U.Component),Or=Object(M.pure)(hr,"Taxonomy");function gr(e){return(gr="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function wr(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}function Sr(e){return(Sr=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}function Pr(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function jr(e,t){return(jr=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}function _r(e,t,r){return t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}var Cr=function(e){function t(){var e,r,n,o;!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t);for(var c=arguments.length,i=new Array(c),a=0;a<c;a++)i[a]=arguments[a];return n=this,o=(e=Sr(t)).call.apply(e,[this].concat(i)),r=!o||"object"!==gr(o)&&"function"!=typeof o?Pr(n):o,_r(Pr(r),"supportedFields",["post-excerpt"]),_r(Pr(r),"getFieldOption",(function(){var e=Pr(r).props,t=e.postField,n=e.fieldType,o=e.content;return n&&"taxonomy"===n&&o?React.createElement(Or,e):t&&r.supportedFields.includes(t.value)?React.createElement(sr,e):null})),r}var r,n,o;return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&jr(e,t)}(t,e),r=t,(n=[{key:"render",value:function(){var e=this.getFieldOption();return e?React.createElement(L.PanelBody,{title:Object(c.__)("Field Options","wpv-views"),initialOpen:!0},e):""}}])&&wr(r.prototype,n),o&&wr(r,o),t}(U.Component),Er=Object(M.pure)(Cr,"FieldOptions");r.d(t,"assureString",(function(){return ve})),r.d(t,"withPostPreview",(function(){return Ae})),r.d(t,"fetchDynamicContent",(function(){return y})),r.d(t,"fetchCache",(function(){return m})),r.d(t,"searchPost",(function(){return v})),r.d(t,"loadSourceFromCustomPost",(function(){return h})),r.d(t,"SaveWrapper",(function(){return Ne})),r.d(t,"EditWrapper",(function(){return et})),r.d(t,"EditOverlay",(function(){return it})),r.d(t,"DynamicSource",(function(){return wt})),r.d(t,"DynamicSourceUnified",(function(){return Ut})),r.d(t,"withToolsetDynamicField",(function(){return Qt})),r.d(t,"getShortcodeOrStatic",(function(){return Xt})),r.d(t,"FieldOptions",(function(){return Er})),r.d(t,"TEXT_CATEGORY",(function(){return"text"})),r.d(t,"NUMBER_CATEGORY",(function(){return"number"})),r.d(t,"IMAGE_CATEGORY",(function(){return"image"})),r.d(t,"DATE_CATEGORY",(function(){return"date"})),r.d(t,"AUDIO_CATEGORY",(function(){return"audio"})),r.d(t,"VIDEO_CATEGORY",(function(){return"video"})),r.d(t,"URL_CATEGORY",(function(){return"url"})),r.d(t,"HTML_CATEGORY",(function(){return"html"}));var Rr=window.WPViews;S(),x(),Rr&&(new ce,new me)}]);